cuda
Initialize dataset with 1294392 characters, 107 unique.
embed_dim: 32
[2020-11-29 19:00] Train Step 0499/1000000, Batch Size = 64,                     Examples/Sec = 5440.30, Accuracy = 0.57, Loss = 1.450
[2020-11-29 19:00] Train Step 0999/1000000, Batch Size = 64,                     Examples/Sec = 5132.12, Accuracy = 0.65, Loss = 1.196
[2020-11-29 19:00] Train Step 1499/1000000, Batch Size = 64,                     Examples/Sec = 6041.63, Accuracy = 0.61, Loss = 1.228
[2020-11-29 19:00] Train Step 1999/1000000, Batch Size = 64,                     Examples/Sec = 5064.34, Accuracy = 0.64, Loss = 1.164
[2020-11-29 19:00] Train Step 2499/1000000, Batch Size = 64,                     Examples/Sec = 5471.02, Accuracy = 0.63, Loss = 1.194
[2020-11-29 19:00] Train Step 2999/1000000, Batch Size = 64,                     Examples/Sec = 5605.25, Accuracy = 0.67, Loss = 1.072
[2020-11-29 19:00] Train Step 3499/1000000, Batch Size = 64,                     Examples/Sec = 5348.28, Accuracy = 0.66, Loss = 1.119
[2020-11-29 19:00] Train Step 3999/1000000, Batch Size = 64,                     Examples/Sec = 5545.39, Accuracy = 0.67, Loss = 1.073
[2020-11-29 19:01] Train Step 4499/1000000, Batch Size = 64,                     Examples/Sec = 5549.74, Accuracy = 0.67, Loss = 1.041
[2020-11-29 19:01] Train Step 4999/1000000, Batch Size = 64,                     Examples/Sec = 5975.19, Accuracy = 0.65, Loss = 1.116
[2020-11-29 19:01] Train Step 5499/1000000, Batch Size = 64,                     Examples/Sec = 5282.91, Accuracy = 0.67, Loss = 1.093
[2020-11-29 19:01] Train Step 5999/1000000, Batch Size = 64,                     Examples/Sec = 5992.13, Accuracy = 0.66, Loss = 1.132
[2020-11-29 19:01] Train Step 6499/1000000, Batch Size = 64,                     Examples/Sec = 5419.76, Accuracy = 0.67, Loss = 1.065
[2020-11-29 19:01] Train Step 6999/1000000, Batch Size = 64,                     Examples/Sec = 5324.73, Accuracy = 0.66, Loss = 1.157
[2020-11-29 19:01] Train Step 7499/1000000, Batch Size = 64,                     Examples/Sec = 5435.24, Accuracy = 0.67, Loss = 1.083
[2020-11-29 19:01] Train Step 7999/1000000, Batch Size = 64,                     Examples/Sec = 5870.26, Accuracy = 0.68, Loss = 1.008
[2020-11-29 19:02] Train Step 8499/1000000, Batch Size = 64,                     Examples/Sec = 5419.98, Accuracy = 0.68, Loss = 1.060
[2020-11-29 19:02] Train Step 8999/1000000, Batch Size = 64,                     Examples/Sec = 5386.81, Accuracy = 0.67, Loss = 1.032
[2020-11-29 19:02] Train Step 9499/1000000, Batch Size = 64,                     Examples/Sec = 5840.89, Accuracy = 0.70, Loss = 1.002
[2020-11-29 19:02] Train Step 9999/1000000, Batch Size = 64,                     Examples/Sec = 5819.61, Accuracy = 0.66, Loss = 1.080
[2020-11-29 19:02] Train Step 10499/1000000, Batch Size = 64,                     Examples/Sec = 5420.31, Accuracy = 0.66, Loss = 1.073
[2020-11-29 19:02] Train Step 10999/1000000, Batch Size = 64,                     Examples/Sec = 5547.45, Accuracy = 0.68, Loss = 1.033
[2020-11-29 19:02] Train Step 11499/1000000, Batch Size = 64,                     Examples/Sec = 5450.36, Accuracy = 0.68, Loss = 1.025
[2020-11-29 19:02] Train Step 11999/1000000, Batch Size = 64,                     Examples/Sec = 5542.52, Accuracy = 0.70, Loss = 0.950
[2020-11-29 19:02] Train Step 12499/1000000, Batch Size = 64,                     Examples/Sec = 5480.06, Accuracy = 0.66, Loss = 1.138
[2020-11-29 19:03] Train Step 12999/1000000, Batch Size = 64,                     Examples/Sec = 5448.70, Accuracy = 0.70, Loss = 0.983
[2020-11-29 19:03] Train Step 13499/1000000, Batch Size = 64,                     Examples/Sec = 5297.82, Accuracy = 0.64, Loss = 1.121
[2020-11-29 19:03] Train Step 13999/1000000, Batch Size = 64,                     Examples/Sec = 5562.16, Accuracy = 0.68, Loss = 1.019
[2020-11-29 19:03] Train Step 14499/1000000, Batch Size = 64,                     Examples/Sec = 5448.81, Accuracy = 0.69, Loss = 1.014
[2020-11-29 19:03] Train Step 14999/1000000, Batch Size = 64,                     Examples/Sec = 5420.09, Accuracy = 0.68, Loss = 1.016
[2020-11-29 19:03] Train Step 15499/1000000, Batch Size = 64,                     Examples/Sec = 5562.16, Accuracy = 0.69, Loss = 1.014
[2020-11-29 19:03] Train Step 15999/1000000, Batch Size = 64,                     Examples/Sec = 5474.48, Accuracy = 0.67, Loss = 1.055
[2020-11-29 19:03] Train Step 16499/1000000, Batch Size = 64,                     Examples/Sec = 5118.52, Accuracy = 0.69, Loss = 0.982
[2020-11-29 19:03] Train Step 16999/1000000, Batch Size = 64,                     Examples/Sec = 5400.25, Accuracy = 0.68, Loss = 1.052
[2020-11-29 19:04] Train Step 17499/1000000, Batch Size = 64,                     Examples/Sec = 5504.56, Accuracy = 0.68, Loss = 1.036
[2020-11-29 19:04] Train Step 17999/1000000, Batch Size = 64,                     Examples/Sec = 5513.15, Accuracy = 0.68, Loss = 1.026
[2020-11-29 19:04] Train Step 18499/1000000, Batch Size = 64,                     Examples/Sec = 5535.21, Accuracy = 0.69, Loss = 0.982
[2020-11-29 19:04] Train Step 18999/1000000, Batch Size = 64,                     Examples/Sec = 5488.13, Accuracy = 0.70, Loss = 0.966
[2020-11-29 19:04] Train Step 19499/1000000, Batch Size = 64,                     Examples/Sec = 5509.99, Accuracy = 0.70, Loss = 1.001
[2020-11-29 19:04] Train Step 19999/1000000, Batch Size = 64,                     Examples/Sec = 5357.99, Accuracy = 0.70, Loss = 0.980
Done training.
Final loss: 1.036302924156189
Final acc: 0.6776041666666667
Traceback (most recent call last):
  File "train.py", line 248, in <module>
    draw_plot(acc, loss, config.seq_length)
  File "train.py", line 177, in draw_plot
    plt.fill_between(range(len(mean)), mean - std, mean + std, alpha=0.2)
TypeError: object of type 'numpy.float64' has no len()
srun: error: r30n2: task 0: Exited with exit code 1
