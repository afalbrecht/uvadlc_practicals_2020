cuda
Initialize dataset with 1294392 characters, 107 unique.
embed_dim: 32
[2020-11-29 19:11] Train Step 0499/1000000, Batch Size = 64,                     Examples/Sec = 5564.24, Accuracy = 0.57, Loss = 1.450
[2020-11-29 19:11] Train Step 0999/1000000, Batch Size = 64,                     Examples/Sec = 5516.67, Accuracy = 0.65, Loss = 1.196
[2020-11-29 19:12] Train Step 1499/1000000, Batch Size = 64,                     Examples/Sec = 5783.38, Accuracy = 0.61, Loss = 1.228
[2020-11-29 19:12] Train Step 1999/1000000, Batch Size = 64,                     Examples/Sec = 5537.03, Accuracy = 0.64, Loss = 1.164
[2020-11-29 19:12] Train Step 2499/1000000, Batch Size = 64,                     Examples/Sec = 5628.29, Accuracy = 0.63, Loss = 1.194
[2020-11-29 19:12] Train Step 2999/1000000, Batch Size = 64,                     Examples/Sec = 5770.82, Accuracy = 0.67, Loss = 1.072
[2020-11-29 19:12] Train Step 3499/1000000, Batch Size = 64,                     Examples/Sec = 5540.35, Accuracy = 0.66, Loss = 1.119
[2020-11-29 19:12] Train Step 3999/1000000, Batch Size = 64,                     Examples/Sec = 5895.92, Accuracy = 0.67, Loss = 1.073
[2020-11-29 19:12] Train Step 4499/1000000, Batch Size = 64,                     Examples/Sec = 5090.17, Accuracy = 0.67, Loss = 1.041
[2020-11-29 19:12] Train Step 4999/1000000, Batch Size = 64,                     Examples/Sec = 6139.04, Accuracy = 0.65, Loss = 1.116
[2020-11-29 19:12] Train Step 5499/1000000, Batch Size = 64,                     Examples/Sec = 5794.74, Accuracy = 0.67, Loss = 1.093
[2020-11-29 19:13] Train Step 5999/1000000, Batch Size = 64,                     Examples/Sec = 5761.90, Accuracy = 0.66, Loss = 1.132
[2020-11-29 19:13] Train Step 6499/1000000, Batch Size = 64,                     Examples/Sec = 5520.07, Accuracy = 0.67, Loss = 1.065
[2020-11-29 19:13] Train Step 6999/1000000, Batch Size = 64,                     Examples/Sec = 5944.62, Accuracy = 0.66, Loss = 1.157
[2020-11-29 19:13] Train Step 7499/1000000, Batch Size = 64,                     Examples/Sec = 6017.52, Accuracy = 0.67, Loss = 1.083
[2020-11-29 19:13] Train Step 7999/1000000, Batch Size = 64,                     Examples/Sec = 5595.55, Accuracy = 0.68, Loss = 1.008
[2020-11-29 19:13] Train Step 8499/1000000, Batch Size = 64,                     Examples/Sec = 5301.59, Accuracy = 0.68, Loss = 1.060
[2020-11-29 19:13] Train Step 8999/1000000, Batch Size = 64,                     Examples/Sec = 5148.16, Accuracy = 0.67, Loss = 1.032
[2020-11-29 19:13] Train Step 9499/1000000, Batch Size = 64,                     Examples/Sec = 5581.13, Accuracy = 0.70, Loss = 1.002
[2020-11-29 19:13] Train Step 9999/1000000, Batch Size = 64,                     Examples/Sec = 5341.36, Accuracy = 0.66, Loss = 1.080
[2020-11-29 19:14] Train Step 10499/1000000, Batch Size = 64,                     Examples/Sec = 5423.38, Accuracy = 0.66, Loss = 1.073
[2020-11-29 19:14] Train Step 10999/1000000, Batch Size = 64,                     Examples/Sec = 5516.21, Accuracy = 0.68, Loss = 1.033
[2020-11-29 19:14] Train Step 11499/1000000, Batch Size = 64,                     Examples/Sec = 5840.63, Accuracy = 0.68, Loss = 1.025
[2020-11-29 19:14] Train Step 11999/1000000, Batch Size = 64,                     Examples/Sec = 5736.17, Accuracy = 0.70, Loss = 0.950
[2020-11-29 19:14] Train Step 12499/1000000, Batch Size = 64,                     Examples/Sec = 5385.62, Accuracy = 0.66, Loss = 1.138
[2020-11-29 19:14] Train Step 12999/1000000, Batch Size = 64,                     Examples/Sec = 5840.63, Accuracy = 0.70, Loss = 0.983
[2020-11-29 19:14] Train Step 13499/1000000, Batch Size = 64,                     Examples/Sec = 5554.22, Accuracy = 0.64, Loss = 1.121
[2020-11-29 19:14] Train Step 13999/1000000, Batch Size = 64,                     Examples/Sec = 5512.13, Accuracy = 0.68, Loss = 1.019
[2020-11-29 19:14] Train Step 14499/1000000, Batch Size = 64,                     Examples/Sec = 5957.29, Accuracy = 0.69, Loss = 1.014
[2020-11-29 19:15] Train Step 14999/1000000, Batch Size = 64,                     Examples/Sec = 5547.33, Accuracy = 0.68, Loss = 1.016
[2020-11-29 19:15] Train Step 15499/1000000, Batch Size = 64,                     Examples/Sec = 5480.29, Accuracy = 0.69, Loss = 1.014
[2020-11-29 19:15] Train Step 15999/1000000, Batch Size = 64,                     Examples/Sec = 5892.04, Accuracy = 0.67, Loss = 1.055
[2020-11-29 19:15] Train Step 16499/1000000, Batch Size = 64,                     Examples/Sec = 5834.54, Accuracy = 0.69, Loss = 0.982
[2020-11-29 19:15] Train Step 16999/1000000, Batch Size = 64,                     Examples/Sec = 5858.86, Accuracy = 0.68, Loss = 1.052
[2020-11-29 19:15] Train Step 17499/1000000, Batch Size = 64,                     Examples/Sec = 5474.14, Accuracy = 0.68, Loss = 1.036
[2020-11-29 19:15] Train Step 17999/1000000, Batch Size = 64,                     Examples/Sec = 5753.75, Accuracy = 0.68, Loss = 1.026
[2020-11-29 19:15] Train Step 18499/1000000, Batch Size = 64,                     Examples/Sec = 5694.67, Accuracy = 0.69, Loss = 0.982
[2020-11-29 19:16] Train Step 18999/1000000, Batch Size = 64,                     Examples/Sec = 5410.04, Accuracy = 0.70, Loss = 0.966
[2020-11-29 19:16] Train Step 19499/1000000, Batch Size = 64,                     Examples/Sec = 5347.64, Accuracy = 0.70, Loss = 1.001
[2020-11-29 19:16] Train Step 19999/1000000, Batch Size = 64,                     Examples/Sec = 5382.92, Accuracy = 0.70, Loss = 0.980
Done training.
Final loss: 1.036302924156189
Final acc: 0.6776041666666667
Traceback (most recent call last):
  File "train.py", line 240, in <module>
    draw_plot(acc, loss, config.seq_length)
  File "train.py", line 178, in draw_plot
    plt.savefig(f'/home/lgpu0376/code/output_dir/loss_acc_kant_{seq_length}.png')
  File "/home/lgpu0376/.conda/envs/dl2020/lib/python3.7/site-packages/matplotlib/pyplot.py", line 859, in savefig
    res = fig.savefig(*args, **kwargs)
  File "/home/lgpu0376/.conda/envs/dl2020/lib/python3.7/site-packages/matplotlib/figure.py", line 2311, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/home/lgpu0376/.conda/envs/dl2020/lib/python3.7/site-packages/matplotlib/backend_bases.py", line 2217, in print_figure
    **kwargs)
  File "/home/lgpu0376/.conda/envs/dl2020/lib/python3.7/site-packages/matplotlib/backend_bases.py", line 1639, in wrapper
    return func(*args, **kwargs)
  File "/home/lgpu0376/.conda/envs/dl2020/lib/python3.7/site-packages/matplotlib/backends/backend_agg.py", line 512, in print_png
    dpi=self.figure.dpi, metadata=metadata, pil_kwargs=pil_kwargs)
  File "/home/lgpu0376/.conda/envs/dl2020/lib/python3.7/site-packages/matplotlib/image.py", line 1605, in imsave
    image.save(fname, **pil_kwargs)
  File "/home/lgpu0376/.conda/envs/dl2020/lib/python3.7/site-packages/PIL/Image.py", line 2148, in save
    fp = builtins.open(filename, "w+b")
FileNotFoundError: [Errno 2] No such file or directory: '/home/lgpu0376/code/output_dir/loss_acc_kant_30.png'
srun: error: r30n2: task 0: Exited with exit code 1
